<!DOCTYPE html>
<html>
<head>
    <title>Профиль</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <div class="header">
        <a href="{{ url_for('home') }}" class="menu-btn">На главную</a>
    </div>
    
    <div class="posts-container">
        <h2>Профиль пользователя</h2>
        
        <div class="profile-info">
            <p><strong>Никнейм:</strong> {{ username }}</p>
            <p><strong>Почта:</strong> {{ email }}</p>
            <p><strong>Роль:</strong> {{ role }}</p>
            <div class="description-section">
                <p><strong>Описание:</strong></p>
                <form id="description-form" onsubmit="updateDescription(event)">
                    <textarea 
                        id="user-description" 
                        class="description-input"
                        placeholder="Расскажите о себе..."
                    >{{ description if description else '' }}</textarea>
                    <button type="submit" class="menu-btn">Сохранить</button>
                </form>
            </div>
        </div>

        <div class="friends-section">
            <h3>Поиск пользователей</h3>
            <div class="search-friends">
                <input type="text" 
                       id="friend-search" 
                       class="search-input" 
                       placeholder="Введите имя пользователя">
                <div id="search-results" class="search-results"></div>
            </div>
        </div>

        <div class="privacy-section">
            <h3>Настройки приватности</h3>
            <br>Если у вас закрытый профиль, то друзья не могут видеть ваши сохраненные мероприятия </br>
            <br> </br>
            <form id="privacy-form" onsubmit="updatePrivacy(event)">
                <label class="privacy-toggle">
                    <input type="checkbox" 
                           id="privacy-checkbox" 
                           {{ 'checked' if user.is_private else '' }}>
                    <span class="slider"></span>
                    <span class="labels">
                        <span class="public">Открытый</span>
                        <span class="private">Закрытый</span>
                    </span>
                </label>
                <button type="submit" class="menu-btn">Сохранить</button>
            </form>
        </div>

        <div class="friends-list-section">
            <h3>Ваши друзья</h3>
            <div class="friends-container">
                {% for friend in user.friends %}
                    <a href="{{ url_for('user_profile', username=friend.username) }}" 
                       class="friend-item">
                        <span>{{ friend.username }}</span>
                    </a>
                {% else %}
                    <p class="empty-message">У вас пока нет друзей</p>
                {% endfor %}
            </div>
        </div>

        <!-- Входящие запросы -->
        <div class="friend-requests-section">
            <h3>Входящие запросы</h3>
            <div id="friend-requests-list"></div>
        </div>

        <!-- Список посещенных мероприятий -->
        <details class="events-section">
            <summary>Посещенные мероприятия</summary>
            <div class="posts-container">
                {% for post in attended_events %}
                    {% include 'post.html' %}
                {% else %}
                <p class="empty-message">Нет посещенных мероприятий</p>
                {% endfor %}
            </div>
        </details>

        <!-- Список планируемых мероприятий -->
        <details class="events-section">
            <summary>Мероприятия в планах</summary>
            <div class="posts-container">
                {% for post in planned_events %}
                    {% include 'post.html' %}
                {% else %}
                <p class="empty-message">Нет мероприятий в планах</p>
                {% endfor %}
            </div>
        </details>
    </div>

    {% include 'modal.html' %}
    

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>